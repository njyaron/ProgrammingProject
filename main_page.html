<!doctype html>

<html lang="en">
<meta charset="utf-8">
<title>Waiting page</title>
<meta name="author" content="Nir Yaron">
<link rel="stylesheet" href="styles.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script>
function getID() {
	//jQuery.get("sign_up")
	//var id = prompt("Write ID:");
	//return parseInt(id);
	return 0;
}

function gotOpponent() {
	return opponentChanged;
}

function waitForOpponent(idx) {
	//Try to get opponent
	if (gotOpponent()) {
		//set global value
		opponentId = 1;
		opponentName = "enemy";
		//Hide waitingSlide
		//$("#waitingSlide").css("visibility", "hidden");
		$("#waitingSlide").slideUp();
		loadBoard();
	}
	else {
		var txt = "waiting for opponent" + ".".repeat(idx);
		$("#waitingSlide").text(txt);
		setTimeout(function(){
			waitForOpponent( (idx+1) % 4 );
		}, 1000);
	}
}

function cellPressed(cell) {

}

function createTable(){
	var tbl = document.createElement('table');
	var tableSize = 3;
  for(var i = 0; i < tableSize; i++){
    var tr = tbl.insertRow();
    for(var j = 0; j < tableSize; j++){
      var td = tr.insertCell();
			td.onclick = "cellPressed(this);"
    }
  }
	return tbl;
}

function loadBoard() {
	var tbl = createTable();
	tbl.id = "boardTable";
	$("#board").append(tbl);
}

function register() {
	//sign name and hide "getName" div
	userName = $("name").val();
	$("#getName").hide();

	//get id from server
	id = getID(userName);

	//get opponent id+name from server
	opponentChanged = false;
	waitForOpponent(0);
	$("#waitingSlide").css("visibility", "visible");
	$("#waitingSlide").slideDown();

	//Say that a match was found and start game
}
</script>

<body>
	<!-- <script src="js/scripts.js"></script>   -->
	<div id="insructions">
		<p> The rules of the game are: ... </p>
		<p> But first, you need to register with your name </p>
	</div>

	<div id="getName">
		<p> Enter your name : </p>
		<input type="text" name="name" value="" onchange="register()">
	</div>

	<div id="waitingSlide" style="visibility:hidden;">
		<p id="waitingText"> </p>
	</div>

	<div id="board">
	</div>

	//Temporary
	<div id="getOpponentName">
		<p> Enter enemy name : </p>
		<input type="text" name="opponentName" value="" onchange="opponentChanged = true;">
	</div>


</body>
</html>
